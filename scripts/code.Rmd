---
title: "Lab 1"
author: "vinita vader"
date: "1/5/2021"
output: html_document
---
```{r setup, include=FALSE}
options(Encoding="UTF-8")
knitr::opts_chunk$set(echo = FALSE,
                      warnings = FALSE,
                      message = FALSE,
                      errors = TRUE,
                      eval = TRUE,
                      fig.width = 8, fig.height = 7)

library(tidyverse)
library(rio)
library(here)
library(janitor)
library(stringr)
library(forcats)
library(qgraph)
library(igraph)
library(psych)
library(nFactors)
library(Matrix)
library(ggplot2)
library(lubridate)
here::here()


```

```{r}
data = import(here::here("data", "rstats_tweets.rds"), setclass = "tb_df") %>% 
  characterize() %>% 
  clean_names()

#names(data)
#head(data, 3)

```

```{r}
data %>% 
  select(screen_name) %>%
  group_by(screen_name) %>% 
  count() %>% 
  arrange(desc(n)) %>% 
  data_frame() %>% 
  slice(1:25) %>% 
  ggplot(aes(x = fct_reorder(screen_name), y = n))+
  geom_bar(stat = "identity")+
  coord_flip()
```


```{r}
#Fig2
data <- data %>%
  mutate(month = round_date(data$created_at, # adding month variable
                            unit = "month"))
data <- data %>% 
  group_by(month) %>% 
  mutate(n = n()) # create count variable

data %>% 
  select(month, n) # taking a look

data %>% 
  ggplot(aes(x = month, y = n)) +
  geom_line() +
  geom_smooth() +
  xlim(as_datetime("2008-09-01 00:00:00"), as_datetime("2018-12-31 00:00:00"))

#Fig2.2  
ggplot(data, aes(month, n)) +
  geom_line(aes(y=n), color = "slategrey", size = 2) +
  geom_ribbon(aes(ymin=0, ymax = n), fill = "grey89", alpha = 0.7) +
  geom_smooth(color = "magenta") +
  #geom_smooth(span = 1, se = FALSE, color = "magenta") +
  xlim(as_datetime("2008-09-01 00:00:00"), as_datetime("2018-12-31 00:00:00"))+
  theme_minimal() +
  labs(y = "Number of #rstats tweets",
       x = "Year (data summarized by month)",
       title = "Growth of the #rstats hashtag on twitter over time",
       caption = "Data from Mike Kearny, distributed via #tidytuesday") + 
   theme(plot.title = element_text(size=16),
         axis.title.x = element_text(size=14),
         axis.title.y = element_text(size=14))
```
```


