---
title: "Lab 1"
author: "vinita vader"
date: "1/5/2021"
output: html_document
editor_options: 
  chunk_output_type: console
---
```{r setup, include=FALSE}
options(Encoding="UTF-8")
knitr::opts_chunk$set(echo = FALSE,
                      warnings = FALSE,
                      message = FALSE,
                      errors = TRUE,
                      eval = TRUE,
                      fig.width = 8, fig.height = 7)

library(tidyverse)
library(rio)
library(here)
library(janitor)
library(stringr)
library(forcats)
library(psych)
library(nFactors)
library(Matrix)
library(ggplot2)
here()


```

## Figure 1 Version 1

```{r}
data = import(here("data", "rstats_tweets.rds"), setclass = "tb_df") %>% 
  characterize() %>% 
  clean_names()
```

```{r}
# Creating reordered rows
data_ordered <- data %>% 
  select(screen_name) %>%
  group_by(screen_name) %>% 
  count() %>% 
  arrange(desc(n)) 

data_short <- data_ordered %>% 
  as_tibble() %>% 
  dplyr::slice(1:25)

data_short %>% 
  ggplot(aes(x = fct_reorder(screen_name, n), y = n))+
  geom_bar(stat = "identity")+
  coord_flip()


```

## Figure 1 Version 2

```{r}

data_short %>% 
  ggplot(aes(x = fct_reorder(screen_name, n), y = n))+
  geom_bar(stat = "identity", fill = "cornflowerblue")+
  coord_flip()+
  labs(x = "Twitter Screen Name",
       y = "Count",
       title = "Most prolific #rstats tweeters",
       subtitle = "Top 25 screennames displayed") +
  theme_set(theme_minimal())+
  theme(plot.title = element_text(hjust = -3.4, vjust= 3),                               plot.subtitle = element_text(hjust = -2.2))+
  theme(
    panel.grid.major.y = element_blank(),
    panel.grid.major.x = calc_element("panel.grid.major.y", theme_get())
  )
```


## Figure 2 Version 1

## Figure 2 Version 2

